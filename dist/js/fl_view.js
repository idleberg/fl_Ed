$(function(){$("#myTab a").click(function(e){e.preventDefault(),$(this).tab("show")});var e=$("#hover"),t=$("#footer"),o=$("#screen_info"),l=($(".navbar"),$(".arrow-up")),a=$(".credit"),i=$("#editor"),r=$(".editor-input");if(i.draggable({handle:".panel-heading",scroll:!1,containment:"window",drag:function(){update_pos(i,o,"Dragging…")}}),i.resizable({handles:"se",resize:function(){update_pos(i,o,"Resizing…")}}),e.mouseenter(function(){l.finish().fadeOut(200)}),e.mouseleave(function(){l.finish().fadeOut(200)}),l.delay(3e3).fadeOut(3e3),t.mouseenter(function(){a.finish().fadeIn(200)}),t.mouseleave(function(){a.finish().fadeOut(3e3)}),a.delay(3e3).fadeOut(3e3),r.keyup(function(){use_storage()&&(localStorage.setItem("editor.input",r.val()),debug&&console.log("Typing…"))}),$(".panel-heading").dblclick(function(){$(".panel").toggleClass("panel-fullscreen"),o.text(i.width()+"✕"+i.height()+" — "+i.offset().left+"x "+i.offset().top+"y"),$(".panel-fullscreen").is(":visible")?localStorage.setItem("editor.fullscreen",!0):localStorage.setItem("editor.fullscreen",!1),debug&&console.log("Toggle fullscreen")}),$(".toggle-fullscreen").click(function(){$(".panel").toggleClass("panel-fullscreen"),o.text(i.width()+"✕"+i.height()+" — "+i.offset().left+"x "+i.offset().top+"y"),$(".panel-fullscreen").is(":visible")?localStorage.setItem("editor.fullscreen",!0):localStorage.setItem("editor.fullscreen",!1),debug&&console.log("Toggle fullscreen")}),$(window).resize(function(){o.text(i.width()+"✕"+i.height()+" — "+i.offset().left+"x "+i.offset().top+"y")}),use_storage()){console.log("	localStorage is available!");var s=[];if("true"==$.urlParam("reset")||"1"==$.urlParam("reset")?(console.log("Reset window.localStorage"),set_defaults(),window.location="index.html"):($.urlParam("editor.x")&&(s["editor.x"]=$.urlParam("editor.x"),localStorage.setItem("editor.x",s["editor.x"])),$.urlParam("editor.y")&&(s["editor.y"]=$.urlParam("editor.y"),localStorage.setItem("editor.y",s["editor.y"])),$.urlParam("editor.w")&&(s["editor.w"]=$.urlParam("editor.w"),localStorage.setItem("editor.w",s["editor.w"])),$.urlParam("editor.h")&&(s["editor.h"]=$.urlParam("editor.h"),localStorage.setItem("editor.h",s["editor.h"]))),console.log(localStorage.length),0===localStorage.length)set_defaults();else for(var n=0;n<localStorage.length;n++){var c=localStorage.key(n),d=localStorage.getItem(c);s[c]=d,console.log("	"+c+"="+d)}i.css({position:"absolute",top:s["editor.y"]+"px",left:s["editor.x"]+"px",width:s["editor.w"]+"px",height:s["editor.h"]+"px"}).show(),"true"==s["editor.fullscreen"]?($(".panel").toggleClass("panel-fullscreen"),o.text(i.width()+"✕"+i.height()+" — "+i.offset().left+"x "+i.offset().top+"y")):o.text(s["editor.w"]+"✕"+s["editor.h"]+" — "+s["editor.x"]+"x "+s["editor.y"]+"y"),r.val(s["editor.input"])}else console.log("no native support for HTML5 storage :("),o.text("Editor");i.hover(function(){i.css("z-index","0"),i.removeClass("panel-default").addClass("panel-muted"),$(this).css("z-index","1"),$(this).removeClass("panel-muted").addClass("panel-default")}),$(".export_data").click(function(){for(var e={},t=0;t<localStorage.length;t++){var o=localStorage.key(t),l=localStorage.getItem(o);e[o]=l}json=JSON.stringify(e,null," "),base64=window.btoa(json),hash=CryptoJS.SHA1(base64).toString().substring(0,7),file="fl_Ed-"+hash+".json",console.log("Exporting settings to "+file);var a=document.createElement("a");a.setAttribute("href","data:application/octet-stream;base64,"+base64),a.setAttribute("download",file),a.click()}),$(".close").click(function(){$(i).fadeOut("fast"),debug&&console.log("Hide editor")}),$(".lock-editor",".unlock-editor").click(function(){$(".lock-editor").is(":visible")?($(this).switchClass(".lock-editor",".unlock-editor").html('<i class="fa fa-fw fa-dot-circle-o"></i>'),$(i).resizable("disable").draggable("disable")):($(this).switchClass(".unlock-editor",".lock-editor").html('<i class="fa fa-fw fa-circle-o"></i>'),$(i).resizable("enable").draggable("enable"))}),$(".toggle-editor").click(function(){$(i).fadeToggle("fast"),debug&&console.log("Toggle editor")}),$(".close-menu").click(function(){$(".navmenu").offcanvas("hide")})});